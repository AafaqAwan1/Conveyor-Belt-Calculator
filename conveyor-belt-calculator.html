<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conveyor Belt Design Calculator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Animations for Calculator */
        @keyframes fadeInScale {
            0% { opacity: 0; transform: scale(0.95); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes slideDown {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .fade-in-scale {
            animation: fadeInScale 0.5s ease-in-out forwards;
        }

        .slide-down {
            animation: slideDown 0.3s ease-in-out forwards;
        }

        details summary {
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        details summary:hover {
            background-color: #e5e7eb; /* Tailwind gray-200 */
        }

        /* Result Box Hover Effect */
        .result-box {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .result-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
        }

        /* Smooth Scroll Behavior */
        html {
            scroll-behavior: smooth;
        }

        /* Styles for Animated Title Page */
        :root {
            --main-title-font-size: 5rem;
            --subtitle-font-size: 2.5rem;
            --text-color: white;
            --background-color: #003087;
            --animation-duration: 1.5s;
        }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: Arial, sans-serif;
            overflow-x: hidden;
        }

        .title-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--background-color);
            z-index: 1000;
            transition: transform 0.8s ease-in-out;
        }

        .title-page.hidden {
            transform: translateY(-100%);
        }

        .title-container {
            text-align: center;
        }

        .title, .subtitle {
            color: var(--text-color);
            display: flex;
            justify-content: center;
            margin: 0;
        }

        .title span, .subtitle span {
            display: inline-block;
            opacity: 0;
        }

        .title {
            font-size: var(--main-title-font-size);
            font-weight: bold;
        }

        .subtitle {
            font-size: var(--subtitle-font-size);
        }

        @keyframes slideInFromLeft {
            0% {
                transform: translateX(-100vw);
                opacity: 0;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInFromRight {
            0% {
                transform: translateX(100vw);
                opacity: 0;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .from-left {
            animation: slideInFromLeft var(--animation-duration) ease-in-out forwards;
        }

        .from-right {
            animation: slideInFromRight var(--animation-duration) ease-in-out forwards;
        }

        .continue-btn {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            background: linear-gradient(to right, #ff4d4d, #ff7676); /* Vibrant red gradient for contrast */
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .continue-btn:hover {
            transform: translateX(-50%) scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }

        /* Calculator Container */
        .calculator-page {
            display: none;
            min-height: 100vh;
            background: linear-gradient(to bottom right, #f3f4f6, #d1d5db);
            padding: 24px;
        }

        .calculator-page.visible {
            display: flex;
        }
    </style>
</head>
<body>
    <!-- Animated Title Page -->
    <div class="title-page" id="titlePage">
        <div class="title-container">
            <h1 class="title" id="mainTitle"></h1>
            <h2 class="subtitle" id="subTitle"></h2>
        </div>
        <button class="continue-btn" id="continueBtn">Continue</button>
    </div>

    <!-- Calculator Page -->
    <div class="calculator-page" id="calculatorPage">
        <div class="container max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl p-8">
            <h1 class="text-4xl font-bold text-center text-gray-800 mb-8">Conveyor Belt Design Calculator</h1>

            <!-- Input Form -->
            <div class="space-y-4">
                <!-- Material Properties -->
                <details open class="bg-gray-50 rounded-lg p-4 slide-down">
                    <summary class="text-lg font-semibold text-gray-700 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h10m0 0l-5 5m5-5l-5-5"></path>
                        </svg>
                        Material Properties
                    </summary>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label for="materialType" class="block text-sm font-medium text-gray-600" title="Select the material type or choose custom to specify density">Material Type</label>
                            <select id="materialType" onchange="toggleCustomDensity()" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="55">Coal (55 lb/ft³)</option>
                                <option value="60" selected>Coal (60 lb/ft³)</option>
                                <option value="custom">Custom</option>
                            </select>
                        </div>
                        <div id="customDensityDiv" class="hidden">
                            <label for="customDensity" class="block text-sm font-medium text-gray-600" title="Enter the density of your custom material">Custom Material Density</label>
                            <div class="flex mt-1">
                                <input type="number" id="customDensity" step="any" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500">
                                <select id="customDensityUnit" class="p-2 border border-l-0 border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500">
                                    <option value="lb/ft3">lb/ft³</option>
                                    <option value="kg/m3">kg/m³</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label for="capacity" class="block text-sm font-medium text-gray-600" title="Enter the conveyor capacity">Capacity</label>
                            <div class="flex mt-1">
                                <input type="number" id="capacity" step="any" value="1000" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500">
                                <select id="capacityUnit" class="p-2 border border-l-0 border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500">
                                    <option value="tph">tph</option>
                                    <option value="kg/s">kg/s</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- Conveyor Properties -->
                <details open class="bg-gray-50 rounded-lg p-4 slide-down">
                    <summary class="text-lg font-semibold text-gray-700 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5h6m-3 0v14m-6-7h12"></path>
                        </svg>
                        Conveyor Properties
                    </summary>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label for="conveyorType" class="block text-sm font-medium text-gray-600" title="Choose if the conveyor is level or inclined">Conveyor Type</label>
                            <select id="conveyorType" onchange="toggleInclinationAngle()" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="level">Level</option>
                                <option value="incline" selected>Incline</option>
                            </select>
                        </div>
                        <div>
                            <label for="inclinationAngle" class="block text-sm font-medium text-gray-600" title="Angle of incline in degrees (disabled for level conveyors)">Inclination Angle (°)</label>
                            <input type="number" id="inclinationAngle" step="any" value="18" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="length" class="block text-sm font-medium text-gray-600" title="Length of the conveyor">Conveyor Length</label>
                            <div class="flex mt-1">
                                <input type="number" id="length" step="any" value="1857" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500">
                                <select id="lengthUnit" class="p-2 border border-l-0 border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500">
                                    <option value="ft">ft</option>
                                    <option value="m">m</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label for="beltWidth" class="block text-sm font-medium text-gray-600" title="Width of the conveyor belt">Belt Width</label>
                            <div class="flex mt-1">
                                <input type="number" id="beltWidth" step="any" value="60" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500">
                                <select id="beltWidthUnit" class="p-2 border border-l-0 border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500">
                                    <option value="in">in</option>
                                    <option value="cm">cm</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label for="beltSpeed" class="block text-sm font-medium text-gray-600" title="Speed of the conveyor belt">Belt Speed</label>
                            <div class="flex mt-1">
                                <input type="number" id="beltSpeed" step="any" value="700" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500">
                                <select id="beltSpeedUnit" class="p-2 border border-l-0 border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500">
                                    <option value="fpm">fpm</option>
                                    <option value="m/s">m/s</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- Drive and Pulley -->
                <details open class="bg-gray-50 rounded-lg p-4 slide-down">
                    <summary class="text-lg font-semibold text-gray-700 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        Drive and Pulley
                    </summary>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label for="pulleyType" class="block text-sm font-medium text-gray-600" title="Type of pulley surface">Pulley Type</label>
                            <select id="pulleyType" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="lagged" selected>Lagged</option>
                                <option value="bare">Bare</option>
                            </select>
                        </div>
                        <div>
                            <label for="arcOfContact" class="block text-sm font-medium text-gray-600" title="Angle of belt contact with the pulley in degrees">Arc of Contact (°)</label>
                            <input type="number" id="arcOfContact" step="any" value="180" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="driveEfficiency" class="block text-sm font-medium text-gray-600" title="Efficiency of the drive system (e.g., 90 for 90% or 0.9)">Drive Efficiency</label>
                            <input type="number" id="driveEfficiency" step="any" value="0.9" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="pulleyRPM" class="block text-sm font-medium text-gray-600" title="Revolutions per minute of the pulley (optional)">Pulley RPM (optional)</label>
                            <input type="number" id="pulleyRPM" step="any" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="takeUpType" class="block text-sm font-medium text-gray-600" title="Type of take-up mechanism">Take-Up Type</label>
                            <select id="takeUpType" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="manual">Manual</option>
                                <option value="automatic" selected>Automatic</option>
                            </select>
                        </div>
                    </div>
                </details>

                <!-- Output Units -->
                <details open class="bg-gray-50 rounded-lg p-4 slide-down">
                    <summary class="text-lg font-semibold text-gray-700 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                        Output Units
                    </summary>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label for="outputTensionUnit" class="block text-sm font-medium text-gray-600" title="Unit for tension measurements">Output Tension Unit</label>
                            <select id="outputTensionUnit" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="lb">lb</option>
                                <option value="N">N</option>
                            </select>
                        </div>
                        <div>
                            <label for="outputPowerUnit" class="block text-sm font-medium text-gray-600" title="Unit for power measurements">Output Power Unit</label>
                            <select id="outputPowerUnit" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="HP">HP</option>
                                <option value="kW">kW</option>
                            </select>
                        </div>
                    </div>
                </details>
            </div>

            <!-- Calculate Button -->
            <div class="mt-6 text-center">
                <button onclick="calculateDesign()" class="bg-gradient-to-r from-blue-500 to-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:from-blue-600 hover:to-blue-800 transition-all duration-300 transform hover:scale-105">Calculate Design</button>
            </div>

            <!-- Results -->
            <div id="results" class="hidden mt-8">
                <h2 class="text-2xl font-bold text-gray-800 text-center mb-6">Results</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="resultsContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Animation Script for Title Page
        const mainTitleText = "AAFAQ AHMED";
        const subTitleText = "Conveyor Belt Design Calculator";
        const mainTitleElement = document.getElementById("mainTitle");
        const subTitleElement = document.getElementById("subTitle");
        const titlePage = document.getElementById("titlePage");
        const calculatorPage = document.getElementById("calculatorPage");
        const continueBtn = document.getElementById("continueBtn");

        function clearText(element) {
            element.innerHTML = "";
        }

        function animateText(element, text, delayStart) {
            const chars = text.split("");
            const midPoint = Math.floor(chars.length / 2);

            chars.forEach((char, index) => {
                const span = document.createElement("span");
                span.textContent = char === " " ? "\u00A0" : char;
                element.appendChild(span);

                if (index < midPoint) {
                    span.classList.add("from-left");
                } else {
                    span.classList.add("from-right");
                }
                span.style.animationDelay = `${delayStart + index * 0.1}s`;
            });
        }

        function startAnimation() {
            clearText(mainTitleElement);
            clearText(subTitleElement);
            animateText(mainTitleElement, mainTitleText, 0);
            animateText(subTitleElement, subTitleText, 0.5);
        }

        // Initial animation on page load
        startAnimation();

        // Continue button click handler
        continueBtn.addEventListener("click", () => {
            titlePage.classList.add("hidden");
            setTimeout(() => {
                calculatorPage.classList.add("visible");
            }, 800); // Match the transition duration
        });

        // Calculator Script (Unchanged)
        console.log("Script loaded successfully.");

        // Table 8.3: Maximum Recommended Lump Size
        const maxLumpSize = {
            12: { uniform: 2, mixed: 4 },
            18: { uniform: 4, mixed: 6 },
            24: { uniform: 5, mixed: 8 },
            30: { uniform: 6, mixed: 10 },
            36: { uniform: 7, mixed: 12 },
            42: { uniform: 8, mixed: 14 },
            48: { uniform: 10, mixed: 16 },
            54: { uniform: 11, mixed: 20 },
            60: { uniform: 12, mixed: 24 },
            66: { uniform: 14, mixed: 28 },
            72: { uniform: 16, mixed: 32 }
        };

        // Table 8.4: Maximum Recommended Belt Speeds
        const maxBeltSpeed = {
            14: { coal: 300 },
            16: { coal: 300 },
            18: { coal: 400 },
            20: { coal: 400 },
            24: { coal: 500 },
            30: { coal: 600 },
            36: { coal: 650 },
            42: { coal: 700 },
            48: { coal: 700 },
            54: { coal: 700 },
            60: { coal: 700 },
            66: { coal: 800 },
            72: { coal: 800 }
        };

        // Table 8.5: Capacity at 100 fpm
        const capacityTable = {
            14: { idler20: { 30: 16, 50: 24, 75: 32, 100: 48, 125: 48, 150: 48 },
                  idler35: { 30: 19, 50: 29, 75: 39, 100: 59, 125: 49, 150: 59 },
                  idler30: { 30: 21, 50: 32, 75: 42, 100: 63, 125: 53, 150: 63 } },
            16: { idler20: { 30: 22, 50: 32, 75: 43, 100: 65, 125: 54, 150: 65 },
                  idler35: { 30: 27, 50: 40, 75: 53, 100: 80, 125: 66, 150: 80 },
                  idler30: { 30: 28, 50: 42, 75: 56, 100: 84, 125: 70, 150: 84 } },
            18: { idler20: { 30: 28, 50: 42, 75: 56, 100: 84, 125: 70, 150: 84 },
                  idler35: { 30: 34, 50: 51, 75: 68, 100: 102, 125: 85, 150: 102 },
                  idler30: { 30: 37, 50: 55, 75: 73, 100: 110, 125: 91, 150: 110 } },
            20: { idler20: { 30: 36, 50: 54, 75: 72, 100: 108, 125: 90, 150: 108 },
                  idler35: { 30: 44, 50: 66, 75: 88, 100: 132, 125: 110, 150: 132 },
                  idler30: { 30: 47, 50: 71, 75: 94, 100: 141, 125: 117, 150: 141 } },
            24: { idler20: { 30: 55, 50: 83, 75: 110, 100: 165, 125: 138, 150: 165 },
                  idler35: { 30: 67, 50: 100, 75: 134, 100: 201, 125: 168, 150: 201 },
                  idler30: { 30: 72, 50: 107, 75: 143, 100: 214, 125: 179, 150: 214 } },
            30: { idler20: { 30: 88, 50: 132, 75: 176, 100: 264, 125: 220, 150: 264 },
                  idler35: { 30: 108, 50: 161, 75: 215, 100: 322, 125: 269, 150: 322 },
                  idler30: { 30: 115, 50: 172, 75: 229, 100: 344, 125: 286, 150: 344 } },
            36: { idler20: { 30: 130, 50: 195, 75: 260, 100: 390, 125: 325, 150: 390 },
                  idler35: { 30: 159, 50: 238, 75: 317, 100: 476, 125: 396, 150: 476 },
                  idler30: { 30: 169, 50: 244, 75: 338, 100: 507, 125: 422, 150: 507 } },
            42: { idler20: { 30: 180, 50: 270, 75: 360, 100: 540, 125: 450, 150: 540 },
                  idler35: { 30: 220, 50: 329, 75: 439, 100: 660, 125: 549, 150: 660 },
                  idler30: { 30: 234, 50: 352, 75: 468, 100: 702, 125: 586, 150: 702 } },
            48: { idler20: { 30: 240, 50: 360, 75: 480, 100: 720, 125: 600, 150: 720 },
                  idler35: { 30: 293, 50: 439, 75: 585, 100: 878, 125: 732, 150: 878 },
                  idler30: { 30: 312, 50: 468, 75: 624, 100: 936, 125: 780, 150: 936 } },
            54: { idler20: { 30: 305, 50: 458, 75: 610, 100: 915, 125: 762, 150: 915 },
                  idler35: { 30: 373, 50: 558, 75: 745, 100: 1118, 125: 932, 150: 1118 },
                  idler30: { 30: 397, 50: 595, 75: 793, 100: 1190, 125: 990, 150: 1190 } },
            60: { idler20: { 30: 380, 50: 570, 75: 760, 100: 1140, 125: 950, 150: 1140 },
                  idler35: { 30: 464, 50: 696, 75: 928, 100: 1392, 125: 1160, 150: 1392 },
                  idler30: { 30: 494, 50: 741, 75: 988, 100: 1482, 125: 1235, 150: 1482 } },
            66: { idler20: { 30: 465, 50: 697, 75: 930, 100: 1395, 125: 1163, 150: 1395 },
                  idler35: { 30: 568, 50: 852, 75: 1135, 100: 1703, 125: 1420, 150: 1703 },
                  idler30: { 30: 605, 50: 908, 75: 1210, 100: 1815, 125: 1512, 150: 1815 } },
            72: { idler20: { 30: 557, 50: 837, 75: 1115, 100: 1672, 125: 1395, 150: 1672 },
                  idler35: { 30: 680, 50: 1020, 75: 1360, 100: 2040, 125: 1700, 150: 2040 },
                  idler30: { 30: 725, 50: 1088, 75: 1450, 100: 2175, 125: 1810, 150: 2175 } }
        };

        // Table 8.7: B and Q Values
        const bAndQValues = {
            14: { light: { B: 1, Q: 7 }, medium: { B: 2, Q: 13 }, heavy: { B: 3, Q: 19 } },
            16: { light: { B: 2, Q: 8 }, medium: { B: 3, Q: 14 }, heavy: { B: 4, Q: 21 } },
            18: { light: { B: 3, Q: 9 }, medium: { B: 4, Q: 16 }, heavy: { B: 5, Q: 23 } },
            20: { light: { B: 4, Q: 10 }, medium: { B: 5, Q: 18 }, heavy: { B: 6, Q: 25 } },
            24: { light: { B: 5, Q: 14 }, medium: { B: 6, Q: 21 }, heavy: { B: 7, Q: 29 } },
            30: { light: { B: 6, Q: 19 }, medium: { B: 7, Q: 28 }, heavy: { B: 8, Q: 38 } },
            36: { light: { B: 7, Q: 26 }, medium: { B: 9, Q: 38 }, heavy: { B: 11, Q: 52 } },
            42: { light: { B: 9, Q: 33 }, medium: { B: 11, Q: 50 }, heavy: { B: 14, Q: 66 } },
            48: { light: { B: 12, Q: 40 }, medium: { B: 15, Q: 60 }, heavy: { B: 18, Q: 82 } },
            54: { light: { B: 14, Q: 50 }, medium: { B: 18, Q: 71 }, heavy: { B: 22, Q: 97 } },
            60: { light: { B: 17, Q: 62 }, medium: { B: 21, Q: 85 }, heavy: { B: 27, Q: 115 } },
            66: { light: { B: 20, Q: 75 }, medium: { B: 24, Q: 103 }, heavy: { B: 32, Q: 135 } },
            72: { light: { B: 22, Q: 88 }, medium: { B: 28, Q: 121 }, heavy: { B: 36, Q: 155 } }
        };

        // Table 8.8: K Values
        const kValues = {
            manual: {
                bare: {
                    150: 1.20, 180: 0.97, 190: 0.91, 200: 0.85, 210: 0.80, 220: 0.75, 230: 0.72,
                    240: 0.68, 270: 0.58, 300: 0.51, 330: 0.46, 360: 0.42, 390: 0.39, 420: 0.36,
                    450: 0.33, 480: 0.31
                },
                lagged: {
                    150: 1.00, 180: 0.80, 190: 0.75, 200: 0.71, 210: 0.66, 220: 0.62, 230: 0.59,
                    240: 0.56, 270: 0.49, 300: 0.43, 330: 0.40, 360: 0.36, 390: 0.33, 420: 0.31,
                    450: 0.29, 480: 0.27
                }
            },
            automatic: {
                bare: {
                    150: 0.84, 180: 0.64, 190: 0.59, 200: 0.54, 210: 0.50, 220: 0.46, 230: 0.43,
                    240: 0.40, 270: 0.32, 300: 0.26, 330: 0.22, 360: 0.18, 390: 0.15, 420: 0.13,
                    450: 0.11, 480: 0.09
                },
                lagged: {
                    150: 0.67, 180: 0.50, 190: 0.46, 200: 0.42, 210: 0.38, 220: 0.35, 230: 0.33,
                    240: 0.30, 270: 0.24, 300: 0.19, 330: 0.16, 360: 0.13, 390: 0.11, 420: 0.09,
                    450: 0.07, 480: 0.06
                }
            }
        };

        // Table 8.9: Idler Spacing
        const idlerSpacing = {
            14: { light: 5.5, medium: 5, heavy: 5, return: 10 },
            16: { light: 5.5, medium: 5, heavy: 5, return: 10 },
            18: { light: 5.5, medium: 5, heavy: 5, return: 10 },
            24: { light: 5.5, medium: 4, heavy: 3.5, return: 10 },
            30: { light: 5.5, medium: 4, heavy: 3.5, return: 10 },
            36: { light: 5, medium: 3.5, heavy: 3, return: 10 },
            42: { light: 5, medium: 3.5, heavy: 3, return: 10 },
            48: { light: 4.5, medium: 3.5, heavy: 2.5, return: 10 },
            54: { light: 4.5, medium: 3, heavy: 2.5, return: 10 },
            60: { light: 4.5, medium: 3, heavy: 2.5, return: 9 },
            66: { light: 4.5, medium: 3, heavy: 2.5, return: 9 },
            72: { light: 4.5, medium: 3, heavy: 2.5, return: 9 }
        };

        // Function to interpolate values (for K values or capacities)
        function interpolate(value, x1, x2, y1, y2) {
            return y1 + (value - x1) * (y2 - y1) / (x2 - x1);
        }

        // Function to interpolate K value if arcOfContact is not in the table
        function interpolateKValue(takeUpType, pulleyType, arc) {
            const angles = Object.keys(kValues[takeUpType][pulleyType]).map(Number).sort((a, b) => a - b);
            if (arc <= angles[0]) return kValues[takeUpType][pulleyType][angles[0]];
            if (arc >= angles[angles.length - 1]) return kValues[takeUpType][pulleyType][angles[angles.length - 1]];

            for (let i = 0; i < angles.length - 1; i++) {
                if (arc >= angles[i] && arc <= angles[i + 1]) {
                    const k1 = kValues[takeUpType][pulleyType][angles[i]];
                    const k2 = kValues[takeUpType][pulleyType][angles[i + 1]];
                    const interpolatedK = interpolate(arc, angles[i], angles[i + 1], k1, k2);
                    return interpolatedK;
                }
            }
            return 0.50; // Default fallback
        }

        // Toggle Custom Density Input
        function toggleCustomDensity() {
            const materialType = document.getElementById('materialType').value;
            const customDensityDiv = document.getElementById('customDensityDiv');
            if (materialType === 'custom') {
                customDensityDiv.classList.remove('hidden');
            } else {
                customDensityDiv.classList.add('hidden');
            }
        }

        // Toggle Inclination Angle Input
        function toggleInclinationAngle() {
            const conveyorType = document.getElementById('conveyorType').value;
            const inclinationAngleInput = document.getElementById('inclinationAngle');
            if (conveyorType === 'level') {
                inclinationAngleInput.disabled = true;
                inclinationAngleInput.value = 0; // Set to 0 for level conveyor
            } else {
                inclinationAngleInput.disabled = false;
                if (!inclinationAngleInput.value || inclinationAngleInput.value === '0') {
                    inclinationAngleInput.value = 18; // Default to 18° for incline
                }
            }
        }

        // Initialize the inclination angle state on page load
        window.onload = function() {
            toggleInclinationAngle();
        };

        // Unit Conversion Functions
        function convertLength(value, fromUnit, toUnit) {
            const conversions = {
                'ft': { 'ft': 1, 'm': 0.3048 },
                'm': { 'ft': 3.28084, 'm': 1 }
            };
            return value * conversions[fromUnit][toUnit];
        }

        function convertLengthUnit(value, fromUnit, toUnit) {
            const conversions = {
                'in': { 'in': 1, 'cm': 2.54 },
                'cm': { 'in': 0.393701, 'cm': 1 }
            };
            return value * conversions[fromUnit][toUnit];
        }

        function convertVolumeDensity(value, fromUnit, toUnit) {
            const conversions = {
                'lb/ft3': { 'lb/ft3': 1, 'kg/m3': 16.0185 },
                'kg/m3': { 'lb/ft3': 0.062428, 'kg/m3': 1 }
            };
            return value * conversions[fromUnit][toUnit];
        }

        function convertSpeed(value, fromUnit, toUnit) {
            const conversions = {
                'fpm': { 'fpm': 1, 'm/s': 0.00508 },
                'm/s': { 'fpm': 196.85, 'm/s': 1 }
            };
            return value * conversions[fromUnit][toUnit];
        }

        function convertCapacity(value, fromUnit, toUnit) {
            const conversions = {
                'tph': { 'tph': 1, 'kg/s': (value) => (value * 1000) / 3600 },
                'kg/s': { 'tph': (value) => (value * 3600) / 1000, 'kg/s': 1 }
            };
            return typeof conversions[fromUnit][toUnit] === 'function'
                ? conversions[fromUnit][toUnit](value)
                : value * conversions[fromUnit][toUnit];
        }

        function convertTension(value, fromUnit, toUnit) {
            const conversions = {
                'lb': { 'lb': 1, 'N': 4.44822 },
                'N': { 'lb': 0.224809, 'N': 1 }
            };
            return value * conversions[fromUnit][toUnit];
        }

        function convertPower(value, fromUnit, toUnit) {
            const conversions = {
                'HP': { 'HP': 1, 'kW': 0.7457 },
                'kW': { 'HP': 1.34102, 'kW': 1 }
            };
            return value * conversions[fromUnit][toUnit];
        }

        function calculateDesign() {
            try {
                // Verify DOM elements exist
                const resultsDiv = document.getElementById('results');
                const resultsContentDiv = document.getElementById('resultsContent');
                if (!resultsDiv || !resultsContentDiv) {
                    throw new Error("Results or resultsContent element not found in DOM.");
                }

                // Get input values and units
                let materialType = document.getElementById('materialType').value;
                let materialDensity = materialType === 'custom'
                    ? parseFloat(document.getElementById('customDensity').value)
                    : parseFloat(materialType);
                let materialDensityUnit = materialType === 'custom'
                    ? document.getElementById('customDensityUnit').value
                    : 'lb/ft3';
                let capacity = parseFloat(document.getElementById('capacity').value);
                let capacityUnit = document.getElementById('capacityUnit').value;
                let conveyorType = document.getElementById('conveyorType').value;
                let inclinationAngle = parseFloat(document.getElementById('inclinationAngle').value);
                let length = parseFloat(document.getElementById('length').value);
                let lengthUnit = document.getElementById('lengthUnit').value;
                let beltWidth = parseFloat(document.getElementById('beltWidth').value);
                let beltWidthUnit = document.getElementById('beltWidthUnit').value;
                let beltSpeed = parseFloat(document.getElementById('beltSpeed').value);
                let beltSpeedUnit = document.getElementById('beltSpeedUnit').value;
                let pulleyType = document.getElementById('pulleyType').value;
                let arcOfContactInput = document.getElementById('arcOfContact').value;
                let arcOfContact = arcOfContactInput ? parseFloat(arcOfContactInput) : null;
                let driveEfficiencyInput = document.getElementById('driveEfficiency').value;
                let driveEfficiency = driveEfficiencyInput ? parseFloat(driveEfficiencyInput) : null;
                let pulleyRPMInput = document.getElementById('pulleyRPM').value;
                let pulleyRPM = pulleyRPMInput ? parseFloat(pulleyRPMInput) : null;
                let takeUpType = document.getElementById('takeUpType').value;
                let outputTensionUnit = document.getElementById('outputTensionUnit').value;
                let outputPowerUnit = document.getElementById('outputPowerUnit').value;

                // Enhanced Input Validation
                if (!materialType) throw new Error("Material Type is required.");
                if (isNaN(materialDensity) || materialDensity === null) throw new Error("Invalid Material Density: Must be a valid number.");
                if (isNaN(capacity) || capacity === null) throw new Error("Invalid Capacity: Must be a valid number.");
                if (isNaN(length) || length === null) throw new Error("Invalid Conveyor Length: Must be a valid number.");
                if (isNaN(beltWidth) || beltWidth === null) throw new Error("Invalid Belt Width: Must be a valid number.");
                if (isNaN(beltSpeed) || beltSpeed === null) throw new Error("Invalid Belt Speed: Must be a valid number.");
                if (isNaN(inclinationAngle) || inclinationAngle === null) throw new Error("Invalid Inclination Angle: Must be a valid number.");
                if (isNaN(arcOfContact) || arcOfContact === null) throw new Error("Invalid Arc of Contact: Must be a valid number.");
                if (isNaN(driveEfficiency) || driveEfficiency === null) throw new Error("Invalid Drive Efficiency: Must be a valid number.");

                if (conveyorType === 'incline' && (inclinationAngle <= 0 || inclinationAngle > 90)) throw new Error("Inclination angle must be between 0° and 90° for incline conveyors.");
                if (beltSpeed <= 0) throw new Error("Belt speed must be positive.");
                if (materialDensity <= 0) throw new Error("Material density must be positive.");
                if (arcOfContact <= 0 || arcOfContact > 360) throw new Error("Arc of Contact must be between 0° and 360°.");

                // Handle Drive Efficiency (accept both percentage and decimal)
                if (driveEfficiency > 0 && driveEfficiency <= 1) {
                    driveEfficiency = driveEfficiency;
                } else if (driveEfficiency > 1 && driveEfficiency <= 100) {
                    driveEfficiency = driveEfficiency / 100;
                } else {
                    throw new Error("Drive Efficiency must be between 0 and 1 (e.g., 0.9) or 0 and 100 (e.g., 90 for 90%).");
                }

                // Convert inputs to internal units (imperial: ft, lb, fpm, etc.)
                materialDensity = convertVolumeDensity(materialDensity, materialDensityUnit, 'lb/ft3');
                capacity = convertCapacity(capacity, capacityUnit, 'tph');
                length = convertLength(length, lengthUnit, 'ft');
                beltWidth = convertLengthUnit(beltWidth, beltWidthUnit, 'in');
                beltSpeed = convertSpeed(beltSpeed, beltSpeedUnit, 'fpm');

                // Validate Belt Speed (Table 8.4)
                const maxSpeed = maxBeltSpeed[beltWidth] ? maxBeltSpeed[beltWidth].coal : 800;
                if (beltSpeed > maxSpeed) {
                    throw new Error(`Belt speed (${beltSpeed} fpm) exceeds maximum recommended speed (${maxSpeed} fpm) for belt width ${beltWidth} in and coal.`);
                }

                // Determine material density category for Table 8.7 and 8.9
                const densityCategory = materialDensity <= 50 ? "light" : (materialDensity <= 100 ? "medium" : "heavy");
                const B = bAndQValues[beltWidth] ? bAndQValues[beltWidth][densityCategory].B : 21;
                const Q = bAndQValues[beltWidth] ? bAndQValues[beltWidth][densityCategory].Q : 85;

                // Calculate lift based on inclination angle
                const inclinationAngleRad = inclinationAngle * Math.PI / 180;
                const liftRaw = length * Math.sin(inclinationAngleRad);
                const lift = Math.round(liftRaw);

                // Friction factor C
                const C = 0.022;
                const L0 = 200;

                // Adjusted length (L = belt length * cos(θ))
                const adjustedLengthRaw = length * Math.cos(inclinationAngleRad);
                const adjustedLength = Math.round(adjustedLengthRaw);

                // Total Empty Conveyor Friction Force
                const emptyFrictionCarrying = C * Q * (adjustedLength / 2);
                const emptyFrictionTotal = C * Q * ((adjustedLength / 2) + L0);
                let totalEmptyFriction = emptyFrictionCarrying + emptyFrictionTotal;

                // Load Friction Force
                let loadFriction = C * (adjustedLength + L0) * (100 * capacity) / (3 * beltSpeed);

                // Inclined Load Force
                const inclinedLoad = (100 * capacity * lift) / (3 * beltSpeed);

                // Inclined Belt Force (BH)
                const BH = B * lift;

                // Tight-Side Tension (T1)
                let T1 = totalEmptyFriction + loadFriction + inclinedLoad + BH;

                // Effective Tension (Te)
                let Te = T1 - BH;

                // Slack-Side Tension (T2)
                const K = kValues[takeUpType][pulleyType][arcOfContact] !== undefined
                    ? kValues[takeUpType][pulleyType][arcOfContact]
                    : interpolateKValue(takeUpType, pulleyType, arcOfContact);
                let T2 = Te * K;

                // Takeup Tension
                let takeUpTension = 2 * (T2 - BH);
                if (takeUpTension < 0) {
                    takeUpTension = 0;
                }

                // Tight-Side Tension Excluding BH (T0)
                let T0 = T1 - BH;

                // Maximum Applied Tension (Tmax)
                let maxAppliedTension = T1 + 0.5 * takeUpTension;

                // Horsepower
                let HP = (beltSpeed * Te) / (33000 * driveEfficiency);

                // Check for NaN in calculations
                if (isNaN(HP) || isNaN(T1) || isNaN(Te) || isNaN(T2)) {
                    throw new Error("Calculation resulted in NaN. Check intermediate values.");
                }

                // Standard Horsepower Recommendation
                const standardMotorSizes = [1, 1.5, 2, 3, 5, 7.5, 10, 15, 20, 25, 30, 40, 50, 60, 75, 100, 125, 150, 200, 250, 300, 350, 400, 450, 500, 600, 750, 800, 1000, 1200];
                let recommendedMotorHP = standardMotorSizes.find(size => size >= HP) || 1200;
                const motorConfig = `${recommendedMotorHP} ${outputPowerUnit} motor`;

                // Calculate Idler Spacing (Table 8.9)
                const spacingData = idlerSpacing[beltWidth] || { light: 4.5, medium: 3, heavy: 2.5, return: 9 };
                const carryingIdlerSpacing = spacingData[densityCategory];
                const returnIdlerSpacing = spacingData.return;

                // Calculate Number of Idlers
                const numCarryingIdlers = Math.ceil(adjustedLength / carryingIdlerSpacing) + 1;
                const numReturnIdlers = Math.ceil(adjustedLength / returnIdlerSpacing) + 1;

                // Convert results to user's preferred units
                totalEmptyFriction = convertTension(totalEmptyFriction, 'lb', outputTensionUnit);
                loadFriction = convertTension(loadFriction, 'lb', outputTensionUnit);
                Te = convertTension(Te, 'lb', outputTensionUnit);
                T2 = convertTension(T2, 'lb', outputTensionUnit);
                T1 = convertTension(T1, 'lb', outputTensionUnit);
                T0 = convertTension(T0, 'lb', outputTensionUnit);
                takeUpTension = convertTension(takeUpTension, 'lb', outputTensionUnit);
                maxAppliedTension = convertTension(maxAppliedTension, 'lb', outputTensionUnit);
                HP = convertPower(HP, 'HP', outputPowerUnit);

                // Display Results in Individual Boxes
                const resultsContent = `
                    <div class="result-box bg-blue-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-blue-700">Empty Friction Force</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${totalEmptyFriction.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-green-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-green-700">Loaded Friction Force</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${loadFriction.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-purple-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-purple-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-purple-700">Effective Tension (Te)</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${Te.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-yellow-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-yellow-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-yellow-700">Minimum Slack-Side Tension</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${T2.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-red-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-red-700">Tight-Side Tension (T1)</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${T1.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-indigo-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-indigo-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-indigo-700">Tight-Side Tension Excluding BH (T0)</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${T0.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-teal-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-teal-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-teal-700">Take-Up Force Required</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${takeUpTension.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-pink-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-pink-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-pink-700">Maximum Applied Tension (Tmax)</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${maxAppliedTension.toFixed(0)} ${outputTensionUnit}</p>
                    </div>
                    <div class="result-box bg-orange-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-orange-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-orange-700">Horsepower</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${HP.toFixed(0)} ${outputPowerUnit}</p>
                    </div>
                    <div class="result-box bg-cyan-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-cyan-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-cyan-700">Recommended Motor Size</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${motorConfig}</p>
                    </div>
                    <div class="result-box bg-lime-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-lime-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-lime-700">Carrying Idler Spacing</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${carryingIdlerSpacing.toFixed(1)} ft</p>
                    </div>
                    <div class="result-box bg-amber-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-amber-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-amber-700">Number of Carrying Idlers</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${numCarryingIdlers}</p>
                    </div>
                    <div class="result-box bg-emerald-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-emerald-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-emerald-700">Return Idler Spacing</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${returnIdlerSpacing.toFixed(1)} ft</p>
                    </div>
                    <div class="result-box bg-rose-50 p-4 rounded-lg shadow-md fade-in-scale">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-rose-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h3 class="text-lg font-semibold text-rose-700">Number of Return Idlers</h3>
                        </div>
                        <p class="text-2xl font-bold text-gray-800 mt-2">${numReturnIdlers}</p>
                    </div>
                `;
                resultsContentDiv.innerHTML = resultsContent;
                resultsDiv.classList.remove('hidden');

                // Scroll to results
                resultsDiv.scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Calculation Error:', error.message, error.stack);
                alert(`An error occurred while calculating the design: ${error.message}. Please ensure all required inputs are provided and valid. Check the browser console for more details.`);
                throw error;
            }
        }

        console.log("calculateDesign function defined.");
    </script>
</body>
</html>